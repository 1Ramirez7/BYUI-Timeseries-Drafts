<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="_ch6_lesson2_chocolate_files/libs/clipboard/clipboard.min.js"></script>
<script src="_ch6_lesson2_chocolate_files/libs/quarto-html/quarto.js"></script>
<script src="_ch6_lesson2_chocolate_files/libs/quarto-html/popper.min.js"></script>
<script src="_ch6_lesson2_chocolate_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="_ch6_lesson2_chocolate_files/libs/quarto-html/anchor.min.js"></script>
<link href="_ch6_lesson2_chocolate_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="_ch6_lesson2_chocolate_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="_ch6_lesson2_chocolate_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="_ch6_lesson2_chocolate_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="_ch6_lesson2_chocolate_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="_ch6_lesson2_chocolate_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="_ch6_lesson2_chocolate_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Recall the time series representing the monthly relative number of Google searches for the term “chocolate.” Here is a time plot of the data from 2021 to 2023. Month 1 is January 2021, month 13 is January 2022, and month 25 is January 2023.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chocolatetimeplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="_ch6_lesson2_chocolate_files/figure-html/fig-chocolatetimeplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Time plot of a portion of the chocolate search data.</figcaption>
</figure>
</div>
</div>
</div>
<p>We fit a regression line to these data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chocolateaddreg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="_ch6_lesson2_chocolate_files/figure-html/fig-chocolateaddreg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The regression line is superimposed on the chocolate search time series.</figcaption>
</figure>
</div>
</div>
</div>
<p>Now, we draw a line that is parallel to the regression line (has the same slope) but has a Y-intercept of 0.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chocolateaddparallel" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="_ch6_lesson2_chocolate_files/figure-html/fig-chocolateaddparallel-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: A line parallel to the regression line that passes through the origin is added to the chocolate search time plot.</figcaption>
</figure>
</div>
</div>
</div>
<p>For each month, we find the average amount that the relative number of google seachers that month deviates from the orange line (that is parallel to the regression line and passes through the origin). So, the length of the green line is the same for every January, etc.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-chocolatelinearModelWithSeasonalIndicatorVariables" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="_ch6_lesson2_chocolate_files/figure-html/fig-chocolatelinearModelWithSeasonalIndicatorVariables-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Representation of a linear model with seasonal indicator variables for the chocolate search time series data.</figcaption>
</figure>
</div>
</div>
</div>
<p>When the bottom of the green arrow is on the orange line, the top of the green arrow is the estimate of the value of the time series for that month.</p>
<p>We will create a linear model that includes a constant term for each month. This constant monthly term is called a <strong>seasonal indicator variable</strong>. This name is derived from the fact that each variable indicates (either as 1 or 0) whether a given month is represented. For example, one of the seasonal indicator variables will represent January. It will be equal to 1 for any value of <span class="math inline">\(t\)</span> representing an observation drawn in January and 0 otherwise. Indicator variables are also called <strong>dummy varaibles.</strong></p>
<p>This additive model with seasonal indicator variables can be perceived similarly to other additive models with a seasonal component:</p>
<p><span class="math display">\[
  x_t = m_t + s_t + z_t
\]</span> where <span class="math display">\[
  s_t =
    \begin{cases}
      \beta_1, &amp; t ~\text{falls in season}~ 1 \\
      \beta_2, &amp; t ~\text{falls in season}~ 2 \\
      ⋮~~~~ &amp; ~~~~~~~~~~~~⋮ \\
      \beta_s, &amp; t ~\text{falls in season}~ s
    \end{cases}
\]</span> and <span class="math inline">\(s\)</span> is the number of seasons in one cycle/period, and <span class="math inline">\(n\)</span> is the number of observations, so <span class="math inline">\(t = 1, 2, \ldots, n\)</span> and <span class="math inline">\(i = 1, 2, \ldots, s\)</span>, and <span class="math inline">\(z_t\)</span> is the residual error series, which can be autocorrelated.</p>
<p>It is important to note that <span class="math inline">\(m_t\)</span> does not need to be a constant. It can be a linear trend: <span class="math display">\[
  m_t = \alpha_0 + \alpha_1 t
\]</span> or quadratic: <span class="math display">\[
  m_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2
\]</span> a polynomial of degree <span class="math inline">\(p\)</span>: <span class="math display">\[
  m_t = \alpha_0 + \alpha_1 t + \alpha_2 t^2 + \cdots + \alpha_p t^p
\]</span> or any other function of <span class="math inline">\(t\)</span>.</p>
<p>If <span class="math inline">\(s_t\)</span> has the same value for all corresponding seasons, then we can write the model as: <span class="math display">\[
  x_t = m_t + \beta_{1 + [(t-1) \mod s]} + z_t
\]</span></p>
<p>Putting this all together, if we have a time series that has a linear trend and monthly observations where <span class="math inline">\(t=1\)</span> corresponds to January, then the model becomes: <span class="math display">\[\begin{align*}
  x_t
    &amp;= ~~~~ \alpha_1 t + s_t + z_t \\
    &amp;=
      \begin{cases}
        \alpha_1 t + \beta_1 + z_t, &amp; t = 1, 13, 25, \ldots ~~~~ ~~(January) \\
        \alpha_1 t + \beta_2 + z_t, &amp; t = 2, 14, 26, \ldots ~~~~ ~~(February) \\
        ~~~~~~~~⋮ &amp; ~~~~~~~~~~~~⋮ \\
        \alpha_1 t + \beta_{12} + z_t, &amp; t = 12, 24, 36, \ldots ~~~~ (December)
      \end{cases}
\end{align*}\]</span></p>
<p>This is the model illustrated in <a href="#fig-chocolatelinearModelWithSeasonalIndicatorVariables">Figure&nbsp;4</a>. The orange line represents the term <span class="math inline">\(\alpha_1 t\)</span> and the green arrows represent the values of <span class="math inline">\(\beta_1, ~ \beta_2, ~ \ldots, ~ \beta_{12}\)</span>.</p>
<p>The folded chunk of code below fits the model to the data and computes the estimated parameter values.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>chocolate_month <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"https://byuistats.github.io/timeseries/data/chocolate.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dates =</span> <span class="fu">yearmonth</span>(<span class="fu">ym</span>(Month)),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(dates),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(dates),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stats_time =</span> year <span class="sc">+</span> (month <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">12</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">month_seq =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">factor</span>(month)) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> dates)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>chocolate_lm <span class="ot">&lt;-</span> chocolate_month <span class="sc">|&gt;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(chocolate <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> stats_time <span class="sc">+</span> month))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated parameter values</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>param_est <span class="ot">&lt;-</span> chocolate_lm <span class="sc">|&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The estimated value of <span class="math inline">\(\alpha_1\)</span> is 1.1316416. The estimated values for the <span class="math inline">\(\beta_i\)</span> parameters are:</p>
<div id="tbl-chocolateParameterEstIndicator" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Estimated values of $beta_i$ for the fitted model for chocolate search time series.</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Jan</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Feb</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Mar</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Apr</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">May</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Jun</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">-2227.91</td>
<td style="text-align: center; min-width: 0in;">-2219.305</td>
<td style="text-align: center; min-width: 0in;">-2233.149</td>
<td style="text-align: center; min-width: 0in;">-2233.443</td>
<td style="text-align: center; min-width: 0in;">-2234.838</td>
<td style="text-align: center; min-width: 0in;">-2237.932</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Jul</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Aug</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Sep</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Oct</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Nov</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">-2236.476</td>
<td style="text-align: center; min-width: 0in;">-2237.37</td>
<td style="text-align: center; min-width: 0in;">-2237.515</td>
<td style="text-align: center; min-width: 0in;">-2232.659</td>
<td style="text-align: center; min-width: 0in;">-2223.003</td>
<td style="text-align: center; min-width: 0in;">-2200.098</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
<p>Now, we compute forecasted (future) values for the relative number of Google searches for the word “Chocolate.”</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>num_years_to_forecast <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>new_dat <span class="ot">&lt;-</span> chocolate_month <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(num_years_to_forecast <span class="sc">*</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(stats_time, month) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">stats_time =</span> stats_time <span class="sc">+</span> num_years_to_forecast,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fu">tidy</span>(chocolate_lm) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(estimate),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="fu">rep</span>(<span class="fu">tidy</span>(chocolate_lm) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(estimate), num_years_to_forecast)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>chocolate_forecast <span class="ot">&lt;-</span> chocolate_lm <span class="sc">|&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">new_data=</span><span class="fu">as_tsibble</span>(new_dat, <span class="at">index =</span> stats_time)) </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>chocolate_forecast <span class="sc">|&gt;</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(chocolate_month, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Relative Count of Google Searches"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Google Searches for 'Chocolate' ("</span>, <span class="fu">min</span>(chocolate_month<span class="sc">$</span>year), <span class="st">"-"</span>, <span class="fu">max</span>(chocolate_month<span class="sc">$</span>year), <span class="st">")"</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste0</span>(num_years_to_forecast, <span class="st">"-Year Forecast Based on a Linear Model with Seasonal Indicator Variables"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-chocForecastPlot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="_ch6_lesson2_chocolate_files/figure-html/fig-chocForecastPlot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Forecasted values of the relative number of Google searches for the word ‘chocolate.’</figcaption>
</figure>
</div>
</div>
</div>
<!-- Beginning of two columns -->
<div class="columns">
<div class="column" style="width:45%;">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>new_dat <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> alpha <span class="sc">*</span> stats_time <span class="sc">+</span> beta) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display_partial_table</span>(<span class="at">nrow_head =</span> <span class="dv">4</span>, <span class="at">nrow_tail =</span> <span class="dv">3</span>, <span class="at">decimals =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-chocForecastValues" class="anchored">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;1: Select forecasted values of the relative count of Google searches for ‘chocolate’.</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">stats_time</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">alpha</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">beta</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">2024</td>
<td style="text-align: center; min-width: 0in;">1</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2227.91</td>
<td style="text-align: center; min-width: 0in;">62.532</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2024.083</td>
<td style="text-align: center; min-width: 0in;">2</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2219.305</td>
<td style="text-align: center; min-width: 0in;">71.232</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">2024.167</td>
<td style="text-align: center; min-width: 0in;">3</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2233.149</td>
<td style="text-align: center; min-width: 0in;">57.482</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2024.25</td>
<td style="text-align: center; min-width: 0in;">4</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2233.443</td>
<td style="text-align: center; min-width: 0in;">57.282</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
<td style="text-align: center; min-width: 0in;">⋮</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2028.75</td>
<td style="text-align: center; min-width: 0in;">10</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2232.659</td>
<td style="text-align: center; min-width: 0in;">63.159</td>
</tr>
<tr class="odd">
<td style="text-align: center; min-width: 0in;">2028.833</td>
<td style="text-align: center; min-width: 0in;">11</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2223.003</td>
<td style="text-align: center; min-width: 0in;">72.909</td>
</tr>
<tr class="even">
<td style="text-align: center; min-width: 0in;">2028.917</td>
<td style="text-align: center; min-width: 0in;">12</td>
<td style="text-align: center; min-width: 0in;">1.132</td>
<td style="text-align: center; min-width: 0in;">-2200.098</td>
<td style="text-align: center; min-width: 0in;">95.909</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div><div class="column" style="width:10%;">
<!-- empty column to create gap -->
</div><div class="column" style="width:45%;">
<p><a href="#tbl-chocForecastValues">Table&nbsp;1</a> gives a few of the forecasted values illustrated in <a href="#fig-chocForecastPlot">Figure&nbsp;5</a>.</p>
</div>
</div>
<!-- End of two columns -->

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>