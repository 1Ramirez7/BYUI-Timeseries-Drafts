{
  "hash": "4fd1ed7f438811e1b9d68da1c41d9480",
  "result": {
    "markdown": "---\ntitle: \"Averages for Time Series\"\nsubtitle: \"Chapter 1: Lesson 3\"\nformat: html\neditor: source\nsidebar: false\n---\n\n\n\n```{=html}\n<script type=\"text/javascript\">\n function showhide(id) {\n    var e = document.getElementById(id);\n    e.style.display = (e.style.display == 'block') ? 'none' : 'block';\n }\n \n function openTab(evt, tabName) {\n    var i, tabcontent, tablinks;\n    tabcontent = document.getElementsByClassName(\"tabcontent\");\n    for (i = 0; i < tabcontent.length; i++) {\n        tabcontent[i].style.display = \"none\";\n    }\n    tablinks = document.getElementsByClassName(\"tablinks\");\n    for (i = 0; i < tablinks.length; i++) {\n        tablinks[i].className = tablinks[i].className.replace(\" active\", \"\");\n    }\n    document.getElementById(tabName).style.display = \"block\";\n    evt.currentTarget.className += \" active\";\n }    \n</script>\n```\n\n\n\n## Learning Outcomes\n\n<details>\n<summary>Decompose time series into trends, seasonal variation, and residuals</summary>\n    -   Describe additive decomposition\n    -   Describe multiplicative decomposition\n    -   Define moving average of a time series\n    -   Estimate trend component using moving averages\n</details>\n<details>\n<summary>Use R to describe key features of time series data</summary>\n    -   Import CSV data and convert to tsibble format\n</details>\n<details>\n<summary>Explain the key theoretical concepts of time series decomposition</summary>\n    -   Define smoothing\n    -   Explain a centered moving average\n    -   Explain the differences in additive vs multiplicative estimators of seasonal variation\n</details>\n\n\n\n## Preparation\n\n-   Read Sections 1.5.1-1.5.3\n\n\n## Learning Journal Exchange (10 min)\n\n-   Review another student's journal\n-   What would you add to your learning journal after reading your partner's?\n-   What would you recommend your partner add to their learning journal?\n-   Sign the Learning Journal review sheet for your peer\n\n\n\n## Class Activity: Moving Averages (40 min)\n\n### Derivation\n\n\n\n\n::: {.cell}\n\n:::\n\n\nData representing some value have been collected each month for a few years. This plot represents the first 12 observations in this time series.\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   Suppose you wanted to compute the mean of the observations from the first year ($t = 1$ to $t=12$.) What is the formula you would use to compute this mean? Write this expression without a summation symbol. \n-   To what value of $t$ should this mean be assigned? (If you were to plot this mean on a time plot, where should it go?)\n\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_1_lesson_3_class_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   Suppose you want to compute the mean of one year's worth of observations, beginning at month $t=2$. Write the formula you would use to compute this mean without using a summation symbol. \n-   To what value of $t$ should this mean be assigned? (If you were to plot this mean on a time plot, where should it go?)\n\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_1_lesson_3_class_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   Note that neither of the two means above are appropriately located on an integer value of $t$.\n-   Give the formula that combines the two means above to give one mean that is centered on an integer value of $t$. Do not include a summation symbol in your formula. (Hint: try averaging the two means.)\n-   Upon what value of $t$ is your new mean centered?\n\n:::\n\nWe will now adjust this moving average adjusted so it is centered on any given value of $t$, not just $t=7$.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_1_lesson_3_class_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   Consider the values $x_{t-6}$, $x_{t-5}$, $x_{t-4}$, $x_{t-3}$, $x_{t-2}$, $x_{t-1}$, $x_{t}$, $x_{t+1}$, $x_{t+2}$, $x_{t+3}$, $x_{t+4}$, and $x_{t+5}$.\n    -   Give an expression for the mean of the values. \n    -   Where will this mean be centered?\n-   Consider the values $x_{t-5}$, $x_{t-4}$, $x_{t-3}$, $x_{t-2}$, $x_{t-1}$, $x_{t}$, $x_{t+1}$, $x_{t+2}$, $x_{t+3}$, $x_{t+4}$, $x_{t+5}$, and $x_{t+6}$.\n    -   Give an expression for the mean of the values. \n    -   Where will this mean be centered?\n-   We now combine these two means by averaging them.\n    -   Give an expression for the mean of these two means.\n    -   Where will this combined mean be centered?\n\n:::\n\n\n### Application: Google Trends Searches for \"Chocolate\"\n\nRecall the Google Trends data for the term \"chocolate\" given in the file <a href=\"../data/chocolate.csv\" download>chocolate.csv</a>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\"tsibble\", \"fable\",\n               \"feasts\", \"tsibbledata\",\n               \"fable.prophet\", \"tidyverse\",\n               \"patchwork\", \"rio\")\n\n# read in the data from a csv and make the tsibble\n# change the line below to include your file path\nchocolate_month <- rio::import(\"../data/chocolate.csv\")\nstart_date <- lubridate::ymd(\"2004-01-01\")\ndate_seq <- seq(start_date,\n                start_date + months(nrow(chocolate_month)-1),\n                by = \"1 months\")\nchocolate_tibble <- tibble(\n  dates = date_seq,\n  year = lubridate::year(date_seq),\n  month = lubridate::month(date_seq),\n  value = pull(chocolate_month, chocolate)\n)\nchocolate_month_ts <- chocolate_tibble |>\n  mutate(index = tsibble::yearmonth(dates)) |>\n  as_tsibble(index = index)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   Using any tool (except R functions that automate the process) compute the centered moving average for the chocolate data. To help your check yourself, the value of $\\hat m$ in month 7 should be 35.6667.\n-   Create a plot of your centered moving average. Here are some examples of ways you could display your centered moving average.\n\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_1_lesson_3_class_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nIf you stored your centered moving average in a variable called \"m_hat\" in the \"chocolate_month_ts\" tsibble, you can generate the plot on the right with the R command:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nautoplot(chocolate_month_ts, .vars = value) +\n  labs(\n    x = \"Month\",\n    y = \"Searches\",\n    title = \"Google Searches for 'Chocolate'\"\n  ) +\n  geom_line(aes(x = dates, y = m_hat), color = \"#D55E00\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n:::\n\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   What does the centered moving average reveal about the chocolate search time series?\n\n:::\n\n### Summary\n\n::: {.callout-tip icon=false title=\"Check Your Understanding\"}\n\n-   What does the centered moving average tell us?\n-   Why is a centered moving average helpful when there are seasonal effects?\n-   For the chocolate search data, answer the following questions:\n    -   How many values of $t$ were not assigned a value of the centered moving average?\n    -   Interpret that number in years.\n    -   Does this number depend on the length of the time series?\n\n:::\n\n\n\n## Recap (5 min)\n\n-   Review objectives and key concepts\n-   Clarify questions on course or time series data\n\n\n\n<a href=\"javascript:showhide('Solutions')\"\nstyle=\"font-size:.8em;\">Team Activity</a>\n\n\n## Homework\n\n::: {.callout-note icon=false}\n\n## Chapter 1 Lesson 3\n\n<!-- ## need to update href link to correct files when we get them -->\n\n<a href=\"https://tbrost.github.io/BYUI-Timeseries-Drafts/Homework/HW1_2.qmd\" download=\"TS_HW_1_3.qmd\"> Download Lesson 3 Homework </a>\n\n:::\n\n::: {#Solutions style=\"display:none;\"}\n\nSolutions to Team Activity: \n\n\n:::\n\n",
    "supporting": [
      "chapter_1_lesson_3_class_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}