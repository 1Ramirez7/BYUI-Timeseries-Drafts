{
  "hash": "455b293c874bf3d8a5f9f8dc6a1d95b7",
  "result": {
    "markdown": "---\ntitle: \"Chapter 2: Lesson 1\"\nsubtitle: \"Covariance and Correlation\"\nformat: html\neditor: source\n---\n\n\n\n\n\n## Objectives:\n\n-   Define covariance, correlation\n\n-   Compute covariance and correlation\n\n## Preparation\n\n-   Read Sections 2.1-2.2.2 and 2.2.4\n\n\n## Learning Journal Exchange (10 mins)\n\n-   Review another student's journal\n\n-   What would you add to your learning journal after reading another student's?\n\n-   What would you recommend the other student add to their learning journal?\n\n-   Sign the Learning Journal review sheet for your peer\n\n\n## Class Activity: Variance and Standard Deviation (15 mins)\n\nWe will explore the variance and standard deviation in this section.\n\n-   What do the standard deviation and the variance measure?\n\nThe following code simulates observations of a random variable. We will use these data to explore the variance and standard deviation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set random seed\nset.seed(2412)\n\n# Specify means and standard deviation\nn <- 5        # number of points\nmu <- 10      # mean\nsigma <- 3    # standard deviation\n\n# Simulate normal data\nsim_data <- data.frame(x = round(rnorm(n, mu, sigma), 1)) %>% \n  arrange(x)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nThe data simulated by this process are:\n\n<center>6.9, 7.7, 8.1, 10.8, 13.5</center>\n\n-   Find the mean of these numbers. <!-- 9.4. -->\n\n-   What are some ways to interpret the mean?\n\nThe variance and standard deviation are individual numbers that summarize how far the data are from the mean. We first compute the deviations from the mean, $x - \\bar x$. This is the directed distance from the mean to each data point.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning in is.na(x): is.na() applied to non-(list or vector) of type\n'expression'\n```\n:::\n\n::: {.cell-output-display}\n![](chapter_2_lesson_1_class_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nWe can summarize this information in a table:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> x </th>\n   <th style=\"text-align:center;\"> x - mean(x) </th>\n   <th style=\"text-align:center;\"> Workspace for your use </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 6.9 </td>\n   <td style=\"text-align:center;\"> -2.5 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 7.7 </td>\n   <td style=\"text-align:center;\"> -1.7 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 8.1 </td>\n   <td style=\"text-align:center;\"> -1.3 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 10.8 </td>\n   <td style=\"text-align:center;\"> 1.4 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 13.5 </td>\n   <td style=\"text-align:center;\"> 4.1 </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nHow can we obtain one number that summarizes how spread out the data are from the mean? We may try averaging the deviations from the mean.\n\n-   What is the average deviation from the mean?\n\n-   Will we get the same value with other data sets, or is this just a coincidence?\n\n-   What could you do to prevent this from happening?\n\n-   Apply your idea. Compute the resulting value that summarizes the spread. What do you get?\n\n-   What is the relationship between the sample variance and the sample standard deviation?\n\n-   Use the table above to verify that the sample variance is 7.4.\n\n-   Show that the sample standard deviation is 2.7203.\n\n## Class Activity: Covariance and Correlation (15 mins)\n\n::: callout-caution\nInsert Chpt2App.R\n:::\n\nThe following code simulates $(x,y)$-pairs of random variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Unset random seed\nset.seed(Sys.time())\n\n# Specify means and correlation coefficient\nn <- 50             # number of points\nmu <- c(1.25, 2.5)  # mean vector (mu_x, mu_y)\nsigma_x <- 1        # standard deviation x\nsigma_y <- 3        # standard deviation y\nrho <- 0.8          # correlation coefficient\n\n# Define variance-covariance matrix\nsigma <- matrix(\n  c(sigma_x^2,\n    rho*sigma_x*sigma_y,\n    rho*sigma_x*sigma_y,\n    sigma_y^2),\n  nrow = 2)\n\n# Simulate bivariate normal data\nmvn_data <- MASS::mvrnorm(n, mu, sigma) %>% \n  data.frame() %>% \n  rename(x = X1, y = X2)\n```\n:::\n\n\nThe following table illustrates some of the simulated values. The mean of the $x$ values is $\\bar x = 1.027$. The mean of the $y$ values is $\\bar y =2.393$. We will soon use the values $(x-\\bar x)$, $(x-\\bar x)^2$, $(y-\\bar y)$, $(y-\\bar y)^2$, and $(x-\\bar x)(y-\\bar y)$. For convenience, they are included in the table below.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> i </th>\n   <th style=\"text-align:center;\"> x </th>\n   <th style=\"text-align:center;\"> y </th>\n   <th style=\"text-align:center;\"> x-mean(x) </th>\n   <th style=\"text-align:center;\"> (x-mean(x))^2 </th>\n   <th style=\"text-align:center;\"> y-mean(y) </th>\n   <th style=\"text-align:center;\"> (y-mean(y))^2 </th>\n   <th style=\"text-align:center;\"> (x-mean(x))(y-mean(y)) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1.446 </td>\n   <td style=\"text-align:center;\"> 4.442 </td>\n   <td style=\"text-align:center;\"> 0.419 </td>\n   <td style=\"text-align:center;\"> 0.176 </td>\n   <td style=\"text-align:center;\"> 2.048 </td>\n   <td style=\"text-align:center;\"> 4.196 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">0.859</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 0.055 </td>\n   <td style=\"text-align:center;\"> 1.601 </td>\n   <td style=\"text-align:center;\"> -0.971 </td>\n   <td style=\"text-align:center;\"> 0.943 </td>\n   <td style=\"text-align:center;\"> -0.792 </td>\n   <td style=\"text-align:center;\"> 0.628 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">0.769</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 0.6 </td>\n   <td style=\"text-align:center;\"> 3.421 </td>\n   <td style=\"text-align:center;\"> -0.427 </td>\n   <td style=\"text-align:center;\"> 0.182 </td>\n   <td style=\"text-align:center;\"> 1.028 </td>\n   <td style=\"text-align:center;\"> 1.056 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #56B4E9 !important;\">-0.438</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 2.391 </td>\n   <td style=\"text-align:center;\"> 7.915 </td>\n   <td style=\"text-align:center;\"> 1.364 </td>\n   <td style=\"text-align:center;\"> 1.861 </td>\n   <td style=\"text-align:center;\"> 5.521 </td>\n   <td style=\"text-align:center;\"> 30.486 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">7.533</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 0.313 </td>\n   <td style=\"text-align:center;\"> -0.502 </td>\n   <td style=\"text-align:center;\"> -0.713 </td>\n   <td style=\"text-align:center;\"> 0.509 </td>\n   <td style=\"text-align:center;\"> -2.895 </td>\n   <td style=\"text-align:center;\"> 8.382 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">2.066</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> 1.401 </td>\n   <td style=\"text-align:center;\"> 1.6 </td>\n   <td style=\"text-align:center;\"> 0.374 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> -0.793 </td>\n   <td style=\"text-align:center;\"> 0.629 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #56B4E9 !important;\">-0.297</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: Black !important;\">:</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> : </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: Black !important;\">:</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 48 </td>\n   <td style=\"text-align:center;\"> 1.647 </td>\n   <td style=\"text-align:center;\"> 1.926 </td>\n   <td style=\"text-align:center;\"> 0.62 </td>\n   <td style=\"text-align:center;\"> 0.385 </td>\n   <td style=\"text-align:center;\"> -0.467 </td>\n   <td style=\"text-align:center;\"> 0.218 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #56B4E9 !important;\">-0.29</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 49 </td>\n   <td style=\"text-align:center;\"> 0.289 </td>\n   <td style=\"text-align:center;\"> -0.401 </td>\n   <td style=\"text-align:center;\"> -0.737 </td>\n   <td style=\"text-align:center;\"> 0.544 </td>\n   <td style=\"text-align:center;\"> -2.794 </td>\n   <td style=\"text-align:center;\"> 7.806 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">2.06</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 50 </td>\n   <td style=\"text-align:center;\"> 0.603 </td>\n   <td style=\"text-align:center;\"> 1.365 </td>\n   <td style=\"text-align:center;\"> -0.424 </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> -1.028 </td>\n   <td style=\"text-align:center;\"> 1.058 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">0.436</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> sum </td>\n   <td style=\"text-align:center;\"> 51.341 </td>\n   <td style=\"text-align:center;\"> 119.663 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 38.3 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 323.138 </td>\n   <td style=\"text-align:center;\"> <span style=\"     color: #E69F00 !important;\">77.569</span> </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe simulated values are plotted below, with vertical lines drawn at $x = \\bar x$ and $y = \\bar y$. The first simulated point $(i=1)$ is circled.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_2_lesson_1_class_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nIf the quantity $(x-\\bar x)(y-\\bar y)$ is greater than zero, the points are colored blue. Otherwise, they are colored orange.\n\n-   What color are the points if $(x-\\bar x)$ and $(y-\\bar y)$ have the same sign?\n\n-   What color are the points if $(x-\\bar x)$ and $(y-\\bar y)$ have different signs?\n\nTo compute the sample covariance, we divide the sum of the $(x - \\bar x)(y - \\bar y)$ values by $n-1$:\n\n$$\nCov(x,y) \n=\n\\frac{\\sum\\limits_{i=1}^n (x - \\bar x)(y - \\bar y)}{n-1} \n=\n\\frac{77.569}{50 - 1} \n= \n1.583\n$$\n\nYou can think of this as an \"average\" of the $(x - \\bar x)(y - \\bar y)$ values. The only difference is that we divide by $n-1$ instead of $n$.\n\n-   If there are more blue points than orange points, what should the sign of the sample covariance be? Why?\n-   What does the sample covariance tell us?\n\nThe sample covariance is related to the sample standard deviation of $x$ and $y$ and the sample correlation coefficient between $x$ and $y$.\n\nThe sample standard deviations are:\n\n$$\n\\begin{align*}\ns_x &= \\sqrt{ \\frac{\\sum\\limits_{i=1}^n (x - \\bar x)^2}{n-1} }\n=\n\\sqrt{\n\\frac{\n38.3\n}{\n50-1\n}\n}\n=\n0.884\n\\\\\ns_y &= \\sqrt{ \\frac{\\sum\\limits_{i=1}^n (y - \\bar y)^2}{n-1} }\n=\n\\sqrt{\n\\frac{\n323.138\n}{\n50-1\n}\n}\n=\n2.568\n\\end{align*}\n$$\n\nThe sample correlation coefficient is: $$\nr = \\frac{\\sum\\limits_{i=1}^n (x - \\bar x)(y - \\bar y)}{\\sqrt{\\sum\\limits_{i=1}^n (x - \\bar x)^2} \\sqrt{\\sum\\limits_{i=1}^n (y - \\bar y)^2}} \n=\n\\frac{\n77.569\n}{\n\\sqrt{ 38.3} \n\\sqrt{ 323.138} \n}\n=\n0.697\n$$\n\n-   What do you get if you multiply the equations for $r$, $s_x$, and $s_y$ together? $$\n    \\begin{align*}\n      r \\cdot s_x \\cdot s_y \n      &=\n      \\frac{\\sum\\limits_{i=1}^n (x - \\bar x)(y - \\bar y)}{\\sqrt{\\sum\\limits_{i=1}^n (x - \\bar x)^2} \\sqrt{\\sum\\limits_{i=1}^n (y - \\bar y)^2}} \n      \\cdot \n      \\sqrt{ \\frac{\\sum\\limits_{i=1}^n (x - \\bar x)^2}{n-1} }\n      \\cdot \n      \\sqrt{ \\frac{\\sum\\limits_{i=1}^n (y - \\bar y)^2}{n-1} }\n      \\\\\n      ~&~\\\\\n      &=\\\\\n      ~&~\\\\\n    \\end{align*}\n    $$\n\n-   Use the numerical values above to confirm your result. Any discrepancy is due to roundoff error.\n\n\n```{=html}\n<!-- Solution\n$$\nCov(x,y) = r \\cdot s_x \\cdot s_y \n=\n0.697\n\\cdot \n0.884\n\\cdot \n2.568\n=\n1.583\n$$\n -->\n```\n\n## Team Activity: Computational Practice (15 mins)\n\n\n::: {.cell}\n\n:::\n\n\nWith your assigned partner, compute the following values for the $n=6$ values given in the table below:\n\n-   $\\bar x =$\n\n-   $\\bar y =$\n\n-   $s_x =$\n\n-   $s_y =$\n\n-   $r =$\n\n-   $Cov(x,y) =$\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> i </th>\n   <th style=\"text-align:center;\"> x </th>\n   <th style=\"text-align:center;\"> y </th>\n   <th style=\"text-align:center;\"> x-mean(x) </th>\n   <th style=\"text-align:center;\"> (x-mean(x))^2 </th>\n   <th style=\"text-align:center;\"> y-mean(y) </th>\n   <th style=\"text-align:center;\"> (y-mean(y))^2 </th>\n   <th style=\"text-align:center;\"> (x-mean(x))(y-mean(y)) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> -2.1 </td>\n   <td style=\"text-align:center;\"> 2.8 </td>\n   <td style=\"text-align:center;\"> -1.9 </td>\n   <td style=\"text-align:center;\"> 3.61 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> -1.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> -0.2 </td>\n   <td style=\"text-align:center;\"> 2.2 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> 0.8 </td>\n   <td style=\"text-align:center;\"> 0.9 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> 0.4 </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> 2.3 </td>\n   <td style=\"text-align:center;\"> -1 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 6 </td>\n   <td style=\"text-align:center;\"> -2.4 </td>\n   <td style=\"text-align:center;\"> 3.9 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> sum </td>\n   <td style=\"text-align:center;\"> -1.2 </td>\n   <td style=\"text-align:center;\"> 10.8 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](chapter_2_lesson_1_class_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Recap (5 min)\n\nWorking with your partner, prepare to explain the following concepts to the class:\n\n-   Variance\n\n-   Standard deviation\n\n-   Correlation\n\n-   Covariance\n\n\n\n",
    "supporting": [
      "chapter_2_lesson_1_class_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}